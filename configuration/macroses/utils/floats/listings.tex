\RequirePackage{listings}
\RequirePackage[newfloat]{minted}

% Перевод заголовков в листингах
\renewcommand\lstlistingname{Листинг}
\renewcommand\lstlistlistingname{Листинги}
% Отступ перед подписью листинга

\DeclareCaptionFormat{listing}{
    \hspace{15pt}#1#2#3
}
\captionsetup[lstlisting]{
    format=listing,
    margin=0pt
}
\lstset{
    mathescape=true,
    identifierstyle=\ttfamily,
    keywordstyle=\bfseries,
    commentstyle=\scriptsize\rmfamily,
    basewidth={0.5em,0.5em},
    fontadjust=true,
}

% Требует Python с пакетом pygmentize, зато позволяет верстать очень годные листинги с синтаксической подсветкой
% Запретим minted подсвечивать по его мнению лексические ошибки
\AtBeginEnvironment{minted}{\dontdofcolorbox}
\def\dontdofcolorbox{\renewcommand\fcolorbox[4][]{##4}}

% Общая настройка
\SetupFloatingEnvironment{listing}{name=Листинг}
\SetupFloatingEnvironment{listing}{listname=Листинги}
\captionsetup[listing]{
    format=listing,
    margin=0pt,
}

